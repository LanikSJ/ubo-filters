name: Malware Domains
on:
  # schedule:
  #   - cron: '30 1 * * 1'
  workflow_dispatch:

permissions:
  contents: read
  pull-requests: write
jobs:
  Updates:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd
    - name: Install FOP CLI
      run: npm install -g fop-cli
    - name: Download Malware Domains List
      run: './scripts/checksum-sort.sh filters/malware-domains.txt

        '
    - id: cpr
      name: Create Pull Request
      uses: peter-evans/create-pull-request@c0f553fe549906ede9cf27b5156039d195d2ece0
      with:
        assignees: LanikSJ
        author: ${{ github.actor }} <${{ github.actor }}@users.noreply.github.com>
        body: 'Update Malware Domains Filter List:

          - Updated with *today''s* date

          - Auto-generated by [create-pull-request][1]


          [1]: https://github.com/peter-evans/create-pull-request

          '
        branch: malware-domains-update
        commit-message: 'chore(filters): update malware domains filter list'
        committer: GitHub <noreply@github.com>
        delete-branch: true
        draft: false
        labels: automated pr
        reviewers: LanikSJ
        signoff: false
        title: 'chore(filters): update malware domains filter list'
        token: ${{ secrets.GITHUB_TOKEN }}
    - if: steps.cpr.outputs.pull-request-operation == 'created'
      name: Enable PR Automerge
      uses: peter-evans/enable-pull-request-automerge@a660677d5469627102a1c1e11409dd063606628d
      with:
        merge-method: squash
        pull-request-number: ${{ steps.cpr.outputs.pull-request-number }}
        token: ${{ secrets.GITHUB_TOKEN }}
